qchisq(0.75,50)
x^2 <- chisq.test(test_matrix)$X-squared
x^2 <- chisq.test(test_matrix)$X
x^2 <- 223.4952
chisq <- chisq.test(test_matrix)$X #223.4952
chisq
chisq <- chisq.test(test_matrix)$X-squared #223.4952
chisq
results <- chisq.test(test_matrix) #223.4952
results
results$X-squared
results$X
test_matrix <- matrix[,c(-1,-3,-4,-5)]
chisq.test(test_matrix)
list <- list(0:50)
#       ggplot_build(m)$data[[1]]$count)#, ggplot_build(m)$data[[1]]$density)
matrix <- cbind(list[[1]])
matrix <- as.data.frame(matrix)
names(matrix) <- "j"
matrix$nj <- ggplot_build(m)$data[[1]]$count
matrix$mu <- (matrix$nj * matrix$j) / sum(matrix$nj)
mu <- sum(matrix$mu)
matrix$Pj <- dpois(matrix$nj, mu)
sum_nj <- sum(matrix$nj)
matrix$nj0 <- sum_nj * matrix$Pj
# correction for nj0 <= five
matrix$nj0_smaller_five <- matrix$nj0 <= 5
table(matrix$nj0_smaller_five)
sum(matrix$nj[1:10])
# goodness of fit (chi-square)
test_matrix <- matrix[,c(-1,-3,-4,-5)]
chisq.test(test_matrix)
chisq <- 223.4952
chisq_crit <- qchisq(0.75,50)
chisq > chisq_crit
chisq_crit <- qchisq(0.9,50)
# decision
chisq > chisq_crit
chisq_crit <- qchisq(0.5,50)
# decision
chisq > chisq_crit
results_chisq <- chisq.test(test_matrix)
results_chisq$parameter
results_chisq$statistic
chisq <- results_chisq$statistic
chisq_crit <- qchisq(0.75,50)
# decision
chisq > chisq_crit
chisq <- as.numeric(results_chisq$statistic)
chisq_crit <- qchisq(0.75,50)
# decision
chisq > chisq_crit
as.numeric(results_chisq$statistic)
results_chisq$observed
results_chisq$expected
matrix
results_chisq <- chisq.test(test_matrix$nj)
chisq <- as.numeric(results_chisq$statistic)
chisq_crit <- qchisq(0.75,50)
results_chisq$expected
chisq > chisq_crit
test_matrix <- matrix[,c(-1,-3,-4,-5)]
results_chisq <- chisq.test(test_matrix)
warnings()
results_chisq$expected
matrix$Pj
matrix$nj
matrix$nj0_smaller_five <- matrix$nj0 <= 5
table(matrix$nj0_smaller_five)
sum(matrix$nj[1:10])
matrix
7.2303+2.6029
sum(matrix$nj0[1:10])
sum(matrix$nj[1:10])
matrix_corr <- matrix[-(matrix$nj0_smaller_five),c(-1,-3,-4,-5)]
matrix_corr
list <- list(0:50)
#       ggplot_build(m)$data[[1]]$count)#, ggplot_build(m)$data[[1]]$density)
matrix <- cbind(list[[1]])
matrix <- as.data.frame(matrix)
names(matrix) <- "j"
matrix$nj <- ggplot_build(m)$data[[1]]$count
matrix$mu <- (matrix$nj * matrix$j) / sum(matrix$nj)
mu <- sum(matrix$mu)
matrix$Pj <- dpois(matrix$nj, mu)
sum_nj <- sum(matrix$nj)
matrix$nj0 <- sum_nj * matrix$Pj
matrix$nj0_smaller_five <- matrix$nj0 <= 5
table(matrix$nj0_smaller_five)
matrix
matrix_corr <- matrix[-(matrix$nj0_smaller_five),c(-1,-3,-4,-6)]
matrix_corr
matrix[,c(-1,-3,-4,-6)]$nj[matrix$nj0_smaller_five]
table(matrix$nj0_smaller_five)
matrix[,c(-1,-3,-4,-6)]$nj[!matrix$nj0_smaller_five]
matrix[,c(-1,-3,-4,-6)][!matrix$nj0_smaller_five]
matrix_corr$nj <- matrix[,c(-1,-3,-4,-6)]$nj[!matrix$nj0_smaller_five]
table(matrix$nj0_smaller_five)[1]
list <- list(0:length(as.numeric(table(matrix$nj0_smaller_five)[1])))
matrix <- cbind(list[[1]])
matrix_corr <- cbind(list[[1]])
matrix_corr <- as.data.frame(matrix)
matrix_corr <- as.data.frame(matrix_corr)
names(matrix_corr) <- "nj"
matrix_corr$nj <- matrix[,c(-1,-3,-4,-6)]$nj[!matrix$nj0_smaller_five]
list <- list(0:length(as.numeric(table(matrix$nj0_smaller_five)[1])))
list <- list(0:50)
#       ggplot_build(m)$data[[1]]$count)#, ggplot_build(m)$data[[1]]$density)
matrix <- cbind(list[[1]])
matrix <- as.data.frame(matrix)
names(matrix) <- "j"
matrix$nj <- ggplot_build(m)$data[[1]]$count
matrix$mu <- (matrix$nj * matrix$j) / sum(matrix$nj)
mu <- sum(matrix$mu)
matrix$Pj <- dpois(matrix$nj, mu)
sum_nj <- sum(matrix$nj)
matrix$nj0 <- sum_nj * matrix$Pj
list <- list(0:length(as.numeric(table(matrix$nj0_smaller_five)[1])))
matrix_corr <- cbind(list[[1]])
matrix_corr <- as.data.frame(matrix_corr)
names(matrix_corr) <- "nj"
matrix_corr
list <- list(0:as.numeric(table(matrix$nj0_smaller_five)[1]))
matrix_corr <- cbind(list[[1]])
as.numeric(table(matrix$nj0_smaller_five)[1])
table(matrix$nj0_smaller_five)
list <- list(0:50)
#       ggplot_build(m)$data[[1]]$count)#, ggplot_build(m)$data[[1]]$density)
matrix <- cbind(list[[1]])
matrix <- as.data.frame(matrix)
names(matrix) <- "j"
matrix$nj <- ggplot_build(m)$data[[1]]$count
matrix$mu <- (matrix$nj * matrix$j) / sum(matrix$nj)
mu <- sum(matrix$mu)
matrix$Pj <- dpois(matrix$nj, mu)
sum_nj <- sum(matrix$nj)
matrix$nj0 <- sum_nj * matrix$Pj
# correction for nj0 <= five
matrix$nj0_smaller_five <- matrix$nj0 <= 5
table(matrix$nj0_smaller_five)
list <- list(0:as.numeric(table(matrix$nj0_smaller_five)[1]))
list
matrix_corr <- cbind(list[[1]])
matrix_corr <- as.data.frame(matrix_corr)
names(matrix_corr) <- "nj"
matrix_corr$nj <- matrix_corr[,c(-1,-3,-4,-6)]$nj[!matrix_corr$nj0_smaller_five]
matrix_corr
matrix
list <- list(matrix$j[!matrix$nj0_smaller_five])
list
matrix_corr <- cbind(list[[1]])
matrix_corr <- as.data.frame(matrix_corr)
names(matrix_corr) <- "nj"
list <- list(matrix$j[!matrix$nj0_smaller_five])
matrix_corr <- cbind(list[[1]])
matrix_corr <- as.data.frame(matrix_corr)
names(matrix_corr) <- "j"
matrix_corr$nj <- matrix_corr[,c(-1,-3,-4,-6)]$nj[!matrix$nj0_smaller_five]
matrix_corr
matrix_corr$nj <- matrix_corr[,c(-1,-3,-4,-6)]$nj[!matrix$nj0_smaller_five]
matrix_corr
matrix_corr$nj <- matrix[,c(-1,-3,-4,-6)]$nj[!matrix$nj0_smaller_five]
matrix
matrix_corr
matrix_corr$nj0 <- matrix[,c(-1,-3,-4,-6)]$nj0[!matrix$nj0_smaller_five]
matrix_corr
matrix_corr$nj[1] + sum(matrix$nj[1:10])
sum(matrix$nj[1:10])
42-29
matrix_corr$nj0[1] <- matrix_corr$nj0[1] + sum(matrix$nj0[1:10])
matrix_corr
matrix_corr[1,3] <- matrix_corr$nj0[1] + sum(matrix$nj0[1:10])
matrix_corr
matrix_corr$nj[1] <- matrix_corr$nj[1] + sum(matrix$nj[1:10])
matrix_corr
list <- list(matrix$j[!matrix$nj0_smaller_five])
matrix_corr <- cbind(list[[1]])
matrix_corr <- as.data.frame(matrix_corr)
names(matrix_corr) <- "j"
matrix_corr$nj <- matrix[,c(-1,-3,-4,-6)]$nj[!matrix$nj0_smaller_five]
matrix_corr$nj0 <- matrix[,c(-1,-3,-4,-6)]$nj0[!matrix$nj0_smaller_five]
matrix_corr$nj[1] <- matrix_corr$nj[1] + sum(matrix$nj[1:10])
matrix_corr$nj0[1] <- matrix_corr$nj0[1] + sum(matrix$nj0[1:10])
matrix_corr
matrix$nj0_smaller_five <- matrix$nj0 <= 5
table(matrix$nj0_smaller_five)
list <- list(matrix$j[!matrix$nj0_smaller_five])
matrix_corr <- cbind(list[[1]])
matrix_corr <- as.data.frame(matrix_corr)
names(matrix_corr) <- "j"
matrix_corr$nj <- matrix[,c(-1,-3,-4,-6)]$nj[!matrix$nj0_smaller_five]
matrix_corr$nj0 <- matrix[,c(-1,-3,-4,-6)]$nj0[!matrix$nj0_smaller_five]
matrix_corr
matrix_corr$nj[1] <- matrix_corr$nj[1] + sum(matrix$nj[1:10])
matrix_corr$nj0[1] <- matrix_corr$nj0[1] + sum(matrix$nj0[1:10])
matrix_corr
matrix
matrix_corr
matrix
matrix_corr
matrix_corr
matrix
sum(matrix$nj[23:31])
sum(matrix$nj0[23:31])
matrix_corr
matrix
matrix_corr
sum(matrix$nj0[37:51])
matrix_corr$nj[15] <- matrix_corr$nj[15] + sum(matrix$nj[37:51])
matrix_corr
matrix_corr$nj[15] <- matrix_corr$nj[15] + sum(matrix$nj[37:51])
as.matrix(matrix_corr$nj[15]) <- matrix_corr$nj[15] + sum(matrix$nj[37:51])
as.matrix(matrix_corr)
matrix_corr$nj[15] <- matrix_corr$nj[15] + sum(matrix$nj[37:51])
matrix_corr$nj0[15] <- matrix_corr$nj[14] + sum(matrix$nj[37:51])
matrix_corr[15,2] <- matrix_corr$nj[14] + sum(matrix$nj[37:51])
matrix_corr
matrix_corr[15,3] <- matrix_corr$nj0[14] + sum(matrix$nj0[37:51])
matrix_corr
test_matrix <- matrix_corr[,-1]
results_chisq <- chisq.test(test_matrix)
chisq <- as.numeric(results_chisq$statistic)
chisq_crit <- qchisq(0.75,50)
chisq > chisq_crit
chisq
chisq_crit
matrix_corr$nj <- matrix$nj[!matrix$nj0_smaller_five]
list <- list(matrix$j[!matrix$nj0_smaller_five])
matrix_corr <- cbind(list[[1]])
matrix_corr <- as.data.frame(matrix_corr)
names(matrix_corr) <- "j"
matrix_corr$nj <- matrix[,c(-1,-3,-4,-6)]$nj[!matrix$nj0_smaller_five]
list <- list(matrix$j[!matrix$nj0_smaller_five])
matrix_corr <- cbind(list[[1]])
matrix_corr <- as.data.frame(matrix_corr)
names(matrix_corr) <- "j"
matrix_corr$nj <- matrix$nj[!matrix$nj0_smaller_five]
matrix_corr$nj0 <- matrix$nj0[!matrix$nj0_smaller_five]
matrix_corr
matrix_corr <- matrix[!matrix$nj0_smaller_five]
rm(matrix_corr)
matrix_corr <- matrix[!matrix$nj0_smaller_five,]
matrix_corr
matrix$nj0_smaller_five <- matrix$nj0 <= 5
table(matrix$nj0_smaller_five)
matrix_corr <- matrix[!matrix$nj0_smaller_five,]
matrix_corr$nj[1] <- matrix_corr$nj[1] + sum(matrix$nj[1:10])
matrix_corr$nj0[1] <- matrix_corr$nj0[1] + sum(matrix$nj0[1:10])
matrix_corr$nj[7] <- matrix_corr$nj[7] + sum(matrix$nj[18])
matrix_corr$nj0[7] <- matrix_corr$nj0[7] + sum(matrix$nj0[18])
matrix_corr$nj[8] <- matrix_corr$nj[8] + sum(matrix$nj[20:21])
matrix_corr$nj0[8] <- matrix_corr$nj0[8] + sum(matrix$nj0[20:21])
matrix_corr$nj[9] <- matrix_corr$nj[9] + sum(matrix$nj[23:31])
matrix_corr$nj0[9] <- matrix_corr$nj0[9] + sum(matrix$nj0[23:31])
matrix_corr
matrix_corr[15,2] <- matrix_corr$nj[14] + sum(matrix$nj[37:51])
matrix_corr[15,3] <- matrix_corr$nj0[14] + sum(matrix$nj0[37:51])
matrix_corr
matrix$nj0_smaller_five <- matrix$nj0 <= 5
table(matrix$nj0_smaller_five)
matrix_corr <- matrix[!matrix$nj0_smaller_five,]
matrix_corr$nj[1] <- matrix_corr$nj[1] + sum(matrix$nj[1:10])
matrix_corr$nj0[1] <- matrix_corr$nj0[1] + sum(matrix$nj0[1:10])
matrix_corr$nj[7] <- matrix_corr$nj[7] + sum(matrix$nj[18])
matrix_corr$nj0[7] <- matrix_corr$nj0[7] + sum(matrix$nj0[18])
matrix_corr$nj[8] <- matrix_corr$nj[8] + sum(matrix$nj[20:21])
matrix_corr$nj0[8] <- matrix_corr$nj0[8] + sum(matrix$nj0[20:21])
matrix_corr$nj[9] <- matrix_corr$nj[9] + sum(matrix$nj[23:31])
matrix_corr$nj0[9] <- matrix_corr$nj0[9] + sum(matrix$nj0[23:31])
as.matrix(matrix_corr)
as.matrix(matrix_corr)
matrix_corr[15,2] <- matrix_corr$nj[14] + sum(matrix$nj[37:51])
matrix_corr
matrix$nj0_smaller_five <- matrix$nj0 <= 5
table(matrix$nj0_smaller_five)
matrix_corr <- matrix[!matrix$nj0_smaller_five,]
matrix_corr$nj[1] <- matrix_corr$nj[1] + sum(matrix$nj[1:10])
matrix_corr$nj0[1] <- matrix_corr$nj0[1] + sum(matrix$nj0[1:10])
matrix_corr$nj[7] <- matrix_corr$nj[7] + sum(matrix$nj[18])
matrix_corr$nj0[7] <- matrix_corr$nj0[7] + sum(matrix$nj0[18])
matrix_corr$nj[8] <- matrix_corr$nj[8] + sum(matrix$nj[20:21])
matrix_corr$nj0[8] <- matrix_corr$nj0[8] + sum(matrix$nj0[20:21])
matrix_corr$nj[9] <- matrix_corr$nj[9] + sum(matrix$nj[23:31])
matrix_corr$nj0[9] <- matrix_corr$nj0[9] + sum(matrix$nj0[23:31])
matrix
matrix_corr
matrix_corr[15,2] <- matrix_corr$nj[14] + sum(matrix$nj[37:51])
matrix_corr
matrix_corr$nj[14] <- matrix_corr$nj[14] + sum(matrix$nj[37:51])
matrix_corr$nj0[14] <- matrix_corr$nj0[14] + sum(matrix$nj0[37:51])
matrix_corr$chisq <- ((matrix_corr$nj - matrix_corr$nj0)^2) / matrix_corr$nj0
matrix_corr
list <- list(0:50)
#       ggplot_build(m)$data[[1]]$count)#, ggplot_build(m)$data[[1]]$density)
matrix <- cbind(list[[1]])
matrix <- as.data.frame(matrix)
names(matrix) <- "j"
matrix$nj <- ggplot_build(m)$data[[1]]$count
matrix$mu <- (matrix$nj * matrix$j) / sum(matrix$nj)
mu <- sum(matrix$mu)
matrix$Pj <- dpois(matrix$nj, mu)
sum_nj <- sum(matrix$nj)
matrix$nj0 <- sum_nj * matrix$Pj
# correction for nj0 <= five
matrix$nj0_smaller_five <- matrix$nj0 <= 5
table(matrix$nj0_smaller_five)
matrix_corr <- matrix[!matrix$nj0_smaller_five,]
matrix_corr$nj[1] <- matrix_corr$nj[1] + sum(matrix$nj[1:10])
matrix_corr$nj0[1] <- matrix_corr$nj0[1] + sum(matrix$nj0[1:10])
matrix_corr$nj[7] <- matrix_corr$nj[7] + sum(matrix$nj[18])
matrix_corr$nj0[7] <- matrix_corr$nj0[7] + sum(matrix$nj0[18])
matrix_corr$nj[8] <- matrix_corr$nj[8] + sum(matrix$nj[20:21])
matrix_corr$nj0[8] <- matrix_corr$nj0[8] + sum(matrix$nj0[20:21])
matrix_corr$nj[9] <- matrix_corr$nj[9] + sum(matrix$nj[23:31])
matrix_corr$nj0[9] <- matrix_corr$nj0[9] + sum(matrix$nj0[23:31])
matrix_corr$nj[14] <- matrix_corr$nj[14] + sum(matrix$nj[37:51])
matrix_corr
matrix_corr$nj0[14] <- matrix_corr$nj0[14] + sum(matrix$nj0[37:51])
matrix_corr
matrix_corr$chisq <- ((matrix_corr$nj - matrix_corr$nj0)^2) / matrix_corr$nj0
matrix_corr
chisq <- sum(matrix_corr$chisq)
matrix_corr
chisq <- sum(matrix_corr$chisq)
chisq_crit <- qchisq(0.75,50)
# decision
chisq > chisq_crit
chisq
chisq_crit
((matrix_corr$nj[22] - matrix_corr$nj0[22])^2) / matrix_corr$nj0[22]
((matrix_corr$nj[22] - matrix_corr$nj0[22])^2)
matrix_corr$nj[22]
matrix_corr$nj
matrix_corr
((matrix_corr$nj[1] - matrix_corr$nj0[1])^2) / matrix_corr$nj0[1]
matrix_corr
test_matrix <- matrix_corr[,c(-1,-3,-4,-6,-7)]
test_matrix
results_chisq <- chisq.test(test_matrix)
chisq <- as.numeric(results_chisq$statistic)
chisq_crit <- qchisq(0.75,50)
# decision
chisq > chisq_crit
chisq
chisq_crit
chisq_crit <- qchisq(0.3,50)
chisq_crit
chisq_crit <- qchisq(0.99,50)
chisq_crit
matrix_corr
nrow(matrix_corr)
chisq_crit <- qchisq(0.75,14)
chisq_crit
chisq > chisq_crit
m <- ggplot(mean_data, aes(x = mean_vector)) + geom_histogram(binwidth = 0.09, aes(y=..density..))
m +   geom_vline(xintercept = mean_fun, colour = "red") +
stat_function(fun = dnorm, arg = list(mean = mean_fun, sd = sd_fun), colour = "red") +
xlab("Mean of 1000 (0.2)'s") +
ggtitle("Histogram of Sampling Data with COmparison to Normal Distribution")
chisq_crit <- qchisq(0.5,14)
chisq_crit
chisq_crit <- qchisq(75,14)
chisq_crit
chisq_crit <- qchisq(.75,14)
chisq_crit
chisq.test(test_matrix)
library(kernlab)
data(spam)
set.seed(333)
smallSpam <- spam[sample(dim(spam)[1],size=10),]
spamLabel <- (smallSpam$type=="spam")*1+1
plot(smallSpam$capitalAve,col=spamLabel)
rule1 <- function(x){
prediction <- rep(NA,length(x))
prediction[x > 2.7] <- "spam"
prediction[x < 2.4] <- "nonspam"
prediction[x >= 2.4 & x <= 2.45] <- "spam"
prediction[x > 2.45 & x <= 2.7] <- "nonspam"
return(prediction)
}
table(rule1(smallSpam$capitalAve), smallSpam$type)
rule2 <- function(x){
prediction <- rep(NA,length(x))
prediction[x > 2.8] <- "spam"
prediction[x <= 2.8] <- "nonspam"
return(prediction)
}
table(rule2(smallSpam$capitalAve), smallSpam$type)
table(rule1(spam$capitalAve),spam$type)
table(rule2(spam$capitalAve),spam$type)
sum(rule1(spam$capitalAve)==spam$type)
sum(rule2(spam$capitalAve)==spam$type)
install.packages("shiny")
install.packages("rCharts")
library(manipulate)
myPlot <- function(s) {
plot(cars$dist - mean(cars$dist), cars$speed - mean(cars$speed))
abline(0, s)
}
manipulate(myPlot, s = slider(0, 2, step = 0.1))
library(manipulate)
myPlot <- function(s) {
plot(cars$dist - mean(cars$dist), cars$speed - mean(cars$speed))
abline(0, s)
}
manipulate(myPlot, s = slider(0, 2, step = 0.1))
manipulate(myPlot(s), x.s = slider(0, 2, step = 0.1))
manipulate(myPlot, s = slider(0, 2, step = 0.1))
manipulate(myPlot(s), x.s = slider(0, 2, step = 0.1))
manipulate(myPlot(s), s = slider(0, 2, step = 0.1))
manipulate(myPlot(s), s = slider(0, 2, step = 0.1))
install.packages("AppliedPredictiveModeling")
library(caret)
library(AppliedPredictiveModeling)
data(AlzheimerDisease)
adData = data.frame(diagnosis,predictors)
trainIndex = createDataPartition(diagnosis, p = 0.50)
training = adData[trainIndex,]
testing = adData[-trainIndex,]
adData = data.frame(diagnosis,predictors)
testIndex = createDataPartition(diagnosis, p = 0.50,list=FALSE)
training = adData[-testIndex,]
testing = adData[testIndex,]
testing
table(testing)
adData = data.frame(diagnosis,predictors)
testIndex = createDataPartition(diagnosis, p = 0.50,list=FALSE)
training = adData[-testIndex,]
testing = adData[testIndex,]
adData = data.frame(diagnosis,predictors)
train = createDataPartition(diagnosis, p = 0.50,list=FALSE)
test = createDataPartition(diagnosis, p = 0.50,list=FALSE)
table(test)
table(training)
data(concrete)
library(caret)
set.seed(975)
inTrain = createDataPartition(mixtures$CompressiveStrength, p = 3/4)[[1]]
training = mixtures[ inTrain,]
testing = mixtures[-inTrain,]
library(AppliedPredictiveModeling)
data(concrete)
library(caret)
set.seed(975)
inTrain = createDataPartition(mixtures$CompressiveStrength, p = 3/4)[[1]]
training = mixtures[ inTrain,]
testing = mixtures[-inTrain,]
hist(testing$Superplasticizer)
hist(training$Superplasticizer)
hist(testing$Superplasticizer)
hist(training$Superplasticizer)
setwd("~/Dropbox/MOOCs/Coursera/Data Science/09 Data Products/Assignment/Assignment/")
library(shiny)
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
??shiny
?shiny
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runExample("03_reactivity")
runExample("03_reactivity")
runApp()
runApp()
runApp()
runApp()
